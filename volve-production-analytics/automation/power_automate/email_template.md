# Email Template

Use this template in the Power Automate "Send Email" action.

## Subject Line

```
Volve Production Report - {report_date}
```

## Email Body (HTML)

```html
<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: Segoe UI, Arial, sans-serif; line-height: 1.6; color: #333; }
        .header { background-color: #0078d4; color: white; padding: 20px; text-align: center; }
        .content { padding: 20px; }
        .metric-box { display: inline-block; background: #f5f5f5; padding: 15px; margin: 10px; border-radius: 5px; min-width: 150px; text-align: center; }
        .metric-value { font-size: 24px; font-weight: bold; color: #0078d4; }
        .metric-label { font-size: 12px; color: #666; }
        .change-positive { color: #107c10; }
        .change-negative { color: #d13438; }
        table { border-collapse: collapse; width: 100%; margin: 15px 0; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background-color: #0078d4; color: white; }
        .alert { background-color: #fff4ce; border-left: 4px solid #ffb900; padding: 10px; margin: 15px 0; }
        .footer { background-color: #f5f5f5; padding: 15px; text-align: center; font-size: 12px; color: #666; }
        .button { display: inline-block; background: #0078d4; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; margin: 10px 5px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Volve Production Report</h1>
        <p>{report_date}</p>
    </div>

    <div class="content">
        <h2>Key Metrics</h2>

        <div class="metric-box">
            <div class="metric-value">{total_oil_last_month}</div>
            <div class="metric-label">Total Oil (Sm³)</div>
        </div>

        <div class="metric-box">
            <div class="metric-value {mom_change_class}">{mom_change}</div>
            <div class="metric-label">Month-over-Month</div>
        </div>

        <div class="metric-box">
            <div class="metric-value {yoy_change_class}">{yoy_change}</div>
            <div class="metric-label">Year-over-Year</div>
        </div>

        <h2>Top Producing Wellbores</h2>
        <table>
            <tr>
                <th>Rank</th>
                <th>Wellbore</th>
                <th>Oil (Sm³)</th>
                <th>Gas (Sm³)</th>
            </tr>
            {top_wellbores_rows}
        </table>

        <h2>Forecast</h2>
        <p>
            <strong>Next Month Forecast:</strong> {forecast_next_month} Sm³ oil
        </p>

        <!-- Alerts Section (if any) -->
        {alerts_section}

        <h2>Quick Links</h2>
        <a href="{dashboard_link}" class="button">Open Dashboard</a>
        <a href="{sharepoint_link}" class="button">SharePoint Data</a>
    </div>

    <div class="footer">
        <p>This report was automatically generated by the Volve Production Analytics system.</p>
        <p>Questions? Contact the Data Analytics team.</p>
    </div>
</body>
</html>
```

## Placeholder Reference

| Placeholder | Source | Example |
|-------------|--------|---------|
| `{report_date}` | Current date | April 2016 |
| `{total_oil_last_month}` | email_summary.txt or pipeline | 125,432 |
| `{mom_change}` | Calculated | +5.2% |
| `{mom_change_class}` | Conditional | change-positive / change-negative |
| `{yoy_change}` | Calculated | -12.3% |
| `{yoy_change_class}` | Conditional | change-positive / change-negative |
| `{top_wellbores_rows}` | Build from data | HTML table rows |
| `{forecast_next_month}` | forecasts.csv | 118,500 |
| `{alerts_section}` | Conditional | Alert HTML or empty |
| `{dashboard_link}` | Config | https://your-app.streamlit.app |
| `{sharepoint_link}` | Config | SharePoint folder URL |

## Power Automate Expression Examples

**Format date:**
```
formatDateTime(utcNow(), 'MMMM yyyy')
```

**Conditional class for change:**
```
if(greater(float(variables('mom_change')), 0), 'change-positive', 'change-negative')
```

**Build table rows (in Apply to Each):**
```html
<tr>
    <td>@{items('Apply_to_each')?['rank']}</td>
    <td>@{items('Apply_to_each')?['wellbore']}</td>
    <td>@{items('Apply_to_each')?['oil']}</td>
    <td>@{items('Apply_to_each')?['gas']}</td>
</tr>
```

## Plain Text Alternative

For email clients that don't render HTML:

```
VOLVE PRODUCTION REPORT - {report_date}
========================================

KEY METRICS
-----------
Total Oil Last Month: {total_oil_last_month} Sm³
Month-over-Month Change: {mom_change}
Year-over-Year Change: {yoy_change}

TOP WELLBORES
-------------
{top_wellbores}

FORECAST
--------
Next Month: {forecast_next_month} Sm³

LINKS
-----
Dashboard: {dashboard_link}
SharePoint: {sharepoint_link}

---
This report was automatically generated.
```
